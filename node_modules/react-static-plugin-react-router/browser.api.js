"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _react = _interopRequireDefault(require("react"));

var _reactStatic = require("react-static");

var _reactRouterDom = require("react-router-dom");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var Location = (0, _reactRouterDom.withRouter)(function (_ref) {
  var children = _ref.children,
      location = _ref.location;
  return children(location);
});

var _default = function _default(_ref2) {
  var _ref2$RouterProps = _ref2.RouterProps,
      userRouterProps = _ref2$RouterProps === void 0 ? {} : _ref2$RouterProps;
  return {
    Root: function Root(PreviousRoot) {
      return function (_ref3) {
        var children = _ref3.children;
        var Router;
        var basepath = (0, _reactStatic.useBasepath)();
        var staticInfo = (0, _reactStatic.useStaticInfo)();
        var routerProps = {
          basename: basepath // Required

        }; // Test for document to detect the node stage

        if (typeof document !== 'undefined') {
          // If in the browser, just use the browser router
          Router = _reactRouterDom.BrowserRouter;
        } else {
          Router = _reactRouterDom.StaticRouter;
          routerProps.location = staticInfo.path; // Required

          routerProps.context = {}; // Required
        }

        return /*#__PURE__*/_react["default"].createElement(PreviousRoot, null, /*#__PURE__*/_react["default"].createElement(Router, _extends({}, routerProps, userRouterProps), children));
      };
    },
    Routes: function Routes(PreviousRoutes) {
      return function (props) {
        return /*#__PURE__*/_react["default"].createElement(Location, null, function (location) {
          return /*#__PURE__*/_react["default"].createElement(PreviousRoutes, _extends({}, props, {
            location: location
          }));
        });
      };
    }
  };
};

exports["default"] = _default;